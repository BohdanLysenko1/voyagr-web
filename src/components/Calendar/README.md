# Calendar System Documentation\n\nThis document describes the refactored Calendar system architecture that follows modern React best practices.\n\n## Architecture Overview\n\nThe Calendar system has been refactored from a monolithic component into a modular, maintainable architecture:\n\n```\nsrc/\n├── components/\n│   ├── Calendar/\n│   │   ├── Calendar.tsx          # Main calendar container (to be refactored)\n│   │   ├── TimePicker.tsx        # Time selection component\n│   │   ├── EventTypeSelector.tsx # Event type selection\n│   │   └── RepeatOptions.tsx     # Recurring event options\n│   └── NextUp.tsx                # Refactored upcoming events component\n├── hooks/\n│   ├── useCalendarApi.ts         # API integration hook\n│   ├── useCalendarState.ts       # Calendar state management\n│   ├── useEventForm.ts           # Event form state management\n│   └── useModalState.ts          # Modal state management\n├── services/\n│   └── calendarService.ts        # API service layer\n├── types/\n│   └── calendar.ts               # TypeScript definitions\n├── utils/\n│   ├── dateUtils.ts              # Date manipulation utilities\n│   ├── eventUtils.ts             # Event-related utilities\n│   └── timeUtils.ts              # Time parsing and formatting\n└── config/\n    └── eventTypes.ts             # Event type configurations\n```\n\n## Key Features\n\n### ✅ Modular Components\n- **TimePicker**: Reusable time selection with validation\n- **EventTypeSelector**: Visual event type selection with icons\n- **RepeatOptions**: Comprehensive recurring event configuration\n- **NextUp**: Clean upcoming events display\n\n### ✅ Custom Hooks\n- **useCalendarApi**: Complete API integration with caching, offline support, and error handling\n- **useCalendarState**: Calendar state management with optimistic updates\n- **useEventForm**: Form state management with validation\n- **useModalState**: Modal state management with accessibility\n\n### ✅ Utility Classes\n- **TimeUtils**: Time parsing, formatting, and validation\n- **DateUtils**: Date manipulation and formatting\n- **EventUtils**: Event processing, validation, and conversion\n\n### ✅ Service Layer\n- **CalendarService**: API abstraction with caching, offline support, and error handling\n- Configurable endpoints and authentication\n- Mock data support for development\n\n### ✅ Type Safety\n- Comprehensive TypeScript interfaces\n- Strict type checking\n- Generic utility types for API responses\n\n## Usage Examples\n\n### Using the API Hook\n\n```typescript\nimport { useCalendarApi } from '@/hooks/useCalendarApi';\n\nfunction CalendarComponent() {\n  const [apiState, apiActions] = useCalendarApi();\n  \n  const handleCreateEvent = async (eventData) => {\n    const newEvent = await apiActions.createEvent(eventData);\n    if (newEvent) {\n      console.log('Event created:', newEvent);\n    }\n  };\n  \n  if (apiState.loading) return <div>Loading...</div>;\n  if (apiState.error) return <div>Error: {apiState.error}</div>;\n  \n  return (\n    <div>\n      {apiState.events.map(event => (\n        <div key={event.id}>{event.title}</div>\n      ))}\n    </div>\n  );\n}\n```\n\n### Using State Management Hooks\n\n```typescript\nimport { useCalendarState } from '@/hooks/useCalendarState';\nimport { useModalState } from '@/hooks/useModalState';\n\nfunction CalendarContainer() {\n  const calendarState = useCalendarState();\n  const modalState = useModalState();\n  \n  const handleEventClick = (event) => {\n    modalState.openEditEventModal(event);\n  };\n  \n  return (\n    <Calendar \n      currentMonth={calendarState.currentMonth}\n      events={calendarState.events}\n      onEventClick={handleEventClick}\n    />\n  );\n}\n```\n\n### Using Utility Functions\n\n```typescript\nimport { EventUtils } from '@/utils/eventUtils';\nimport { TimeUtils } from '@/utils/timeUtils';\n\n// Get upcoming events\nconst upcomingEvents = EventUtils.getUpcomingEvents(allEvents, 5);\n\n// Format time\nconst timeData = TimeUtils.parseTime('10:30 AM');\nconst formatted = TimeUtils.formatTime(timeData);\n\n// Validate event\nconst errors = EventUtils.validateEvent(eventData);\nif (errors.length === 0) {\n  // Event is valid\n}\n```\n\n## Migration Guide\n\n### From Old Calendar to New System\n\n1. **Replace direct state management**:\n   ```typescript\n   // Old\n   const [events, setEvents] = useState([]);\n   \n   // New\n   const [apiState, apiActions] = useCalendarApi();\n   ```\n\n2. **Use utility functions**:\n   ```typescript\n   // Old\n   const parseTime = (timeString) => { /* complex logic */ };\n   \n   // New\n   import { TimeUtils } from '@/utils/timeUtils';\n   const timeData = TimeUtils.parseTime(timeString);\n   ```\n\n3. **Extract reusable components**:\n   ```typescript\n   // Old\n   <select>{/* time selection logic */}</select>\n   \n   // New\n   <TimePicker value={time} onChange={setTime} onClear={clearTime} />\n   ```\n\n## API Integration\n\n### Development Mode\n```typescript\n// Use mock data\nconst [apiState, apiActions] = useCalendarApi();\nawait apiActions.loadMockData();\n```\n\n### Production Mode\n```typescript\n// Configure service\nimport { CalendarService } from '@/services/calendarService';\n\nconst service = new CalendarService({\n  baseUrl: 'https://api.example.com',\n  apiKey: process.env.NEXT_PUBLIC_API_KEY,\n  timeout: 10000\n});\n```\n\n### Offline Support\nThe system automatically handles offline scenarios:\n- Caches successful requests\n- Returns cached data when offline\n- Shows offline indicators\n- Queues mutations for when connection returns\n\n## Performance Optimizations\n\n### Implemented\n- ✅ Component memoization opportunities\n- ✅ Utility function caching\n- ✅ API response caching\n- ✅ Optimistic updates\n- ✅ Lazy loading support\n\n### Recommended\n- Use `React.memo` for frequently re-rendering components\n- Implement virtual scrolling for large event lists\n- Use `useMemo` for expensive calculations\n- Implement infinite scroll for event pagination\n\n## Testing Strategy\n\n### Unit Tests\n- Test utility functions with edge cases\n- Test custom hooks with React Testing Library\n- Test service layer with mocked responses\n\n### Integration Tests\n- Test component interactions\n- Test API error scenarios\n- Test offline functionality\n\n### E2E Tests\n- Test complete user workflows\n- Test accessibility features\n- Test cross-browser compatibility\n\n## Accessibility Features\n\n- Keyboard navigation support\n- Screen reader compatibility\n- Focus management in modals\n- ARIA labels and descriptions\n- Color contrast compliance\n- Reduced motion support\n\n## Future Enhancements\n\n### Planned Features\n- [ ] Drag and drop event editing\n- [ ] Real-time collaboration\n- [ ] Advanced filtering and search\n- [ ] Calendar sharing\n- [ ] Email notifications\n- [ ] Export functionality\n\n### Technical Improvements\n- [ ] WebSocket integration for real-time updates\n- [ ] Service Worker for better offline support\n- [ ] Calendar view virtualization\n- [ ] Advanced caching strategies\n- [ ] Performance monitoring\n\n## Contributing\n\nWhen contributing to the Calendar system:\n\n1. **Follow the established patterns**\n2. **Add comprehensive TypeScript types**\n3. **Include unit tests for new utilities**\n4. **Update this documentation**\n5. **Consider accessibility in new features**\n6. **Maintain backward compatibility when possible**\n\nThis refactored system provides a solid foundation for a production-ready calendar application while maintaining flexibility for future enhancements.